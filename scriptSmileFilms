CREATE TABLE Roles (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre VARCHAR(30) NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Users (
  id INTEGER AUTO_INCREMENT NOT NULL,
  email VARCHAR(30) NOT NULL,
  Rol_id INTEGER NOT NULL,
  contrasena VARCHAR(30) NOT NULL,  
  PRIMARY KEY (id)
);

CREATE TABLE Clientes (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre VARCHAR(30) NOT NULL,
  apellido VARCHAR(30) NOT NULL,
  fecha_nacimiento DATE NOT NULL,
  tel VARCHAR(11) NOT NULL,
  email VARCHAR(30) NOT NULL,
  Rol_id INTEGER NOT NULL,
  documento VARCHAR(30) NOT NULL,
  ciudad VARCHAR(50) NOT NULL,
  direccion VARCHAR(30) NOT NULL,
  foto BLOB NULL DEFAULT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Empleados (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre VARCHAR(30) NOT NULL,
  apellido VARCHAR(30) NOT NULL,
  tel VARCHAR(11) NOT NULL,
  email VARCHAR(30) NOT NULL,
  Rol_id INTEGER NOT NULL,
  documento VARCHAR(25) NOT NULL,
  fecha_inicio DATE NOT NULL,
  PRIMARY KEY (id)
);
		
CREATE TABLE Prestamos (
  id INTEGER  AUTO_INCREMENT NOT NULL,
  Cliente_id INTEGER NOT NULL,
  Pelicula_id INTEGER NOT NULL,
  fecha_devolucion DATE NOT NULL,
  pago INT NOT NULL,
  Empleado_id INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Peliculas (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre VARCHAR(50) NOT NULL,
  poster BLOB NOT NULL,
  genero_id INTEGER NOT NULL,
  duracion INTEGER NOT NULL,
  estado VARCHAR(50) NOT NULL,
  ejemplar INTEGER NOT NULL,
  descripcion VARCHAR(255) NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Sanciones (
  id INTEGER AUTO_INCREMENT NOT NULL,
  Cliente_id INTEGER NOT NULL,
  fecha_sancion DATE NOT NULL,
  multa INTEGER NOT NULL,
  duracion_sancion INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Reservas (
  id INTEGER AUTO_INCREMENT NOT NULL,
  Cliente_id INTEGER NOT NULL,
  fecha_reserva DATE NOT NULL,
  cantidad_peliculas INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Generos (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre VARCHAR(30) NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Devoluciones (
  id INTEGER AUTO_INCREMENT NOT NULL,
  Prestamo_id INTEGER NOT NULL,
  estado_pelicula INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Reportes (
  id INTEGER AUTO_INCREMENT NOT NULL,
  Prestamos_id INTEGER NOT NULL,
  Devoluciones_id INTEGER NOT NULL,
  Sanciones_id INTEGER NOT NULL,
  Cliente_id INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Sugerencias (
  id INTEGER AUTO_INCREMENT NOT NULL,
  nombre_pelicula DATE NOT NULL,
  descripcion MEDIUMTEXT NOT NULL,
  Cliente_id INTEGER NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE Liquidaciones (
  id INTEGER AUTO_INCREMENT NOT NULL,
  Empleado_id INTEGER NOT NULL,
  dias_laborados INTEGER NOT NULL,
  PRIMARY KEY (id)
);

ALTER TABLE Users ADD FOREIGN KEY (Rol_id) REFERENCES Roles (id);
ALTER TABLE Clientes ADD FOREIGN KEY (Rol_id) REFERENCES Roles (id);
ALTER TABLE Empleados ADD FOREIGN KEY (Rol_id) REFERENCES Roles (id);
ALTER TABLE Prestamos ADD FOREIGN KEY (Cliente_id) REFERENCES Clientes (id);
ALTER TABLE Prestamos ADD FOREIGN KEY (Pelicula_id) REFERENCES Peliculas (id);
ALTER TABLE Prestamos ADD FOREIGN KEY (Empleado_id) REFERENCES Empleados (id);
ALTER TABLE Peliculas ADD FOREIGN KEY (genero_id) REFERENCES Generos (id);
ALTER TABLE Sanciones ADD FOREIGN KEY (Cliente_id) REFERENCES Clientes (id);
ALTER TABLE Reservas ADD FOREIGN KEY (Cliente_id) REFERENCES Clientes (id);
ALTER TABLE Devoluciones ADD FOREIGN KEY (Prestamo_id) REFERENCES Prestamos (id);
ALTER TABLE Reportes ADD FOREIGN KEY (Prestamos_id) REFERENCES Prestamos (id);
ALTER TABLE Reportes ADD FOREIGN KEY (Devoluciones_id) REFERENCES Devoluciones (id);
ALTER TABLE Reportes ADD FOREIGN KEY (Sanciones_id) REFERENCES Sanciones (id);
ALTER TABLE Reportes ADD FOREIGN KEY (Cliente_id) REFERENCES Clientes (id);
ALTER TABLE Sugerencias ADD FOREIGN KEY (Cliente_id) REFERENCES Clientes (id);


Insert into Roles (nombre) values ('Gerente');
Insert into Roles (nombre) values ('Empleado');
Insert into Roles (nombre) values ('Cliente');

Insert into Users (email,Rol_id,contrasena) values ('alejo@gmail.com',1,'123456');

Insert into Clientes (nombre,apellido,fecha_nacimiento,tel,email,Rol_id,documento,ciudad,direccion) values ('Alejandro','González','1990-08-13','33333330','a@gmail.com',1,'2222222222','Itagui','cr 80 # 80 - 80');
Insert into Clientes (nombre,apellido,fecha_nacimiento,tel,email,Rol_id,documento,ciudad,direccion) values ('Raul','Betancur','1987-09-17','4444444','r@gmail.com',1,'111111111','Medellin','cr 80 # 80 - 80');
Insert into Clientes (nombre,apellido,fecha_nacimiento,tel,email,Rol_id,documento,ciudad,direccion) values ('Marlon','Urriago','1992-07-02','5555555','m@gmail.com',1,'7777777777','Itagui','cr 81 # 81 - 81');
Insert into Clientes (nombre,apellido,fecha_nacimiento,tel,email,Rol_id,documento,ciudad,direccion) values ('Wilder','Alvarez','1996-01-30','6666666','w@gmail.com',1,'8888888888','Itagui','cr 81 # 81 - 81');

Insert into Generos (nombre) values ('Terror');

Insert into Peliculas (nombre,genero_id,duracion,estado,ejemplar,descripcion) values ('Cuando las luces se apagan','1','2','Nuevo','5','Cuando su hermano pequeño');